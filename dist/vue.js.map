{"version":3,"file":"vue.js","sources":["../src/observe/index.js","../src/state.js","../src/init.js","../src/index.js"],"sourcesContent":["\nclass Observe {\n  constructor(data) {\n    // 遍历data属性\n    this.walk(data)\n  }\n\n  walk(data) {\n    Object.keys(data).forEach(key => {\n      // 重新定义属性\n      defineReactive(data, key, data[key])\n    })\n  }\n}\n\nexport function defineReactive(data, key, value) {\n\n  observe(value) // 递归处理，对属性的所有数据进行劫持\n\n  // 使用defineProperty 重新定义数据，所以性能比较差，劫持数据响应式变化\n  // defineProperty只能劫持已存在的属性；所以如果属性被删除或者新增，需要使用Vue的其他方法，$set $delete\n  Object.defineProperty(data, key, {\n    get() {\n      console.log(\"get val\")\n      return value\n    },\n    set(newVal) {\n      if (newVal === value) return\n      value = newVal\n      console.log(\"set val\")\n    }\n  })\n}\n\nexport function observe(data) {\n  // 劫持对象属性\n  if (typeof data !== 'object' || data == null) {\n    return\n  }\n\n  return new Observe(data)\n\n}","import { observe } from \"./observe/index\"\n\nexport function initState(vm) {\n  const opts = vm.$options\n  // 对数据进行劫持\n  if (!!opts.data) {\n    initData(vm)\n  }\n}\n\nfunction proxy(vm, target, key) {\n  Object.defineProperty(vm, key, {\n    get() {\n      return vm[target][key]\n    },\n    set(newVal) {\n      vm[target][key] = newVal\n    }\n  })\n}\n\nfunction initData(vm) {\n  let data = vm.$options.data\n   \n  // data可能是函数或者对象，vue3中确定需要为对象；    data.call 的入参？\n  data = typeof data === \"function\"?data.call(vm):data\n\n  vm._data = data\n\n  // 监听劫持data，实现响应式原理 defineProperty\n  observe(data)\n\n  // 对vm._data 进行代理，vm可以直接访问数据\n  for (const key in data) {\n    proxy(vm, \"_data\", key)\n  }\n  \n}","import { initState } from \"./state\"\n\nexport function initMixin(Vue) { // 给Vue增加init方法\n  Vue.prototype._init = function (options) { // 用于初始化操作\n    \n    let vm = this\n    // 将用户传入数据挂在在vue实例中, 方便后续方法获取\n    this.$options = options\n\n    // 初始化状态，1、对数据进行劫持\n    initState(vm)\n\n  }\n}","import { initMixin } from \"./init\"\n\n\nfunction Vue(options) {\n  this._init(options)\n}\n\ninitMixin(Vue) // 扩展init方法，封装initMixin避免在Vue中增加过多的函数，方便扩展，保证代码可读性\n\nexport default Vue"],"names":["Observe","data","_classCallCheck","walk","_createClass","key","value","Object","keys","forEach","defineReactive","observe","defineProperty","get","console","log","set","newVal","_typeof","initState","vm","opts","$options","initData","proxy","target","call","_data","initMixin","Vue","prototype","_init","options"],"mappings":"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"}